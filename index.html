<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visor 360°</title>
    <style>
        body { margin: 0; overflow: hidden; }
        #menu1, #menu2 { position: absolute; top: 10px; z-index: 1000; }
        #menu1 { left: 10px; }
        #menu2 { left: calc(50% + 10px); display: none; }
        #switchViewBtn { position: absolute; top: 10px; left: calc(50% + 110px); z-index: 1000; }
        #vrBtn { position: absolute; bottom: 10px; right: 10px; z-index: 1000; }
        #scene { width: 100vw; height: 100vh; }
        .dual-view #scene { display: flex; }
    </style>
</head>
<body>
    <div id="menu1">
        <select id="photoSelector1">
            <option value="images/image1.JPG">Imagem 1</option>
            <option value="images/image2.JPG">Imagem 2</option>
            <option value="images/image3.JPG">Imagem 3</option>
        </select>
    </div>
    <div id="menu2">
        <select id="photoSelector2">
            <option value="images/image1.JPG">Imagem 1</option>
            <option value="images/image2.JPG">Imagem 2</option>
            <option value="images/image3.JPG">Imagem 3</option>
        </select>
    </div>
    <button id="switchViewBtn">Alternar Visualização</button>
    <button id="vrBtn">VR</button>
    <div id="scene"></div>

    <script src="https://cdn.rawgit.com/pchen66/panolens.js/master/build/panolens.min.js"></script>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script>
        const sceneContainer = document.querySelector('#scene');
        const photoSelector1 = document.querySelector('#photoSelector1');
        const photoSelector2 = document.querySelector('#photoSelector2');
        const switchViewBtn = document.querySelector('#switchViewBtn');
        const vrBtn = document.querySelector('#vrBtn');
        const menu2 = document.querySelector('#menu2');
        let isDualView = false;
        let viewer1, viewer2;

        function initializeViewer() {
            viewer1 = new PANOLENS.Viewer({ container: sceneContainer });
            viewer2 = new PANOLENS.Viewer({ container: sceneContainer });
        }

        function loadPanorama(photoUrl1, photoUrl2) {
            sceneContainer.innerHTML = '';

            if (isDualView) {
                // Carregar dois visores 360°
                const panorama1 = new PANOLENS.ImagePanorama(photoUrl1);
                const panorama2 = new PANOLENS.ImagePanorama(photoUrl2);

                viewer1 = new PANOLENS.Viewer({ container: sceneContainer });
                viewer2 = new PANOLENS.Viewer({ container: sceneContainer });

                viewer1.add(panorama1);
                viewer2.add(panorama2);

                sceneContainer.appendChild(viewer1.container);
                sceneContainer.appendChild(viewer2.container);

                viewer1.container.style.width = '50%';
                viewer2.container.style.width = '50%';
                viewer1.container.style.float = 'left';
                viewer2.container.style.float = 'left';
            } else {
                // Carregar um único visor 360°
                const panorama = new PANOLENS.ImagePanorama(photoUrl1);
                viewer1 = new PANOLENS.Viewer({ container: sceneContainer });
                viewer1.add(panorama);

                sceneContainer.appendChild(viewer1.container);
            }
        }

        function toggleView() {
            isDualView = !isDualView;

            if (isDualView) {
                document.body.classList.add('dual-view');
                loadPanorama(photoSelector1.value, photoSelector2.value);
                menu2.style.display = 'block';
            } else {
                document.body.classList.remove('dual-view');
                loadPanorama(photoSelector1.value, '');
                menu2.style.display = 'none';
            }
        }

        photoSelector1.addEventListener('change', (event) => {
            if (!isDualView) {
                loadPanorama(event.target.value, '');
            } else {
                const currentPhoto2 = photoSelector2.value;
                loadPanorama(event.target.value, currentPhoto2);
            }
        });

        photoSelector2.addEventListener('change', (event) => {
            if (isDualView) {
                const currentPhoto1 = photoSelector1.value;
                loadPanorama(currentPhoto1, event.target.value);
            }
        });

        switchViewBtn.addEventListener('click', toggleView);

        vrBtn.addEventListener('click', () => {
            alert('Modo VR ativado!');
        });

        // Inicializar o visualizador
        initializeViewer();

        // Carregar a primeira foto por padrão
        loadPanorama(photoSelector1.value, '');
    </script>
</body>
</html>
